<!DOCTYPE html>
<html lang="it" data-theme="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestione Auto</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>

<body>
  <header class="header">
    <div class="container header-content">
      <div class="logo-section">
        <div class="logo-icon">
          <i class="fas fa-car-alt"></i>
        </div>
        <div class="logo-text">
          <h1>Gestione Auto</h1>
          <p>Tieni traccia dei tuoi veicoli e manutenzioni</p>
        </div>
      </div>
      <div class="header-actions">
        <button id="themeToggle" class="theme-toggle" aria-label="Passa al tema scuro">
          <i class="fas fa-moon"></i><span class="toggle-label">Scuro</span>
        </button>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="stats-grid">
      <div class="stat-card">
        <div class="stat-content">
          <div>
            <p id="totalVehiclesLabel" class="stat-label">Veicoli Totali</p>
            <h2 id="totalVehicles" class="stat-value">0</h2>
          </div>
          <div class="stat-icon stat-icon-blue">
            <i class="fas fa-car"></i>
          </div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-content">
          <div>
            <p id="totalMaintenancesLabel" class="stat-label">Manutenzioni</p>
            <h2 id="totalMaintenances" class="stat-value">0</h2>
          </div>
          <div class="stat-icon stat-icon-green">
            <i class="fas fa-tools"></i>
          </div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-content">
          <div>
            <p id="activeAlertsLabel" class="stat-label">Scadenze Attive</p>
            <h2 id="activeAlerts" class="stat-value">0</h2>
          </div>
          <div id="alertsIcon" class="stat-icon stat-icon-gray">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
        </div>
      </div>
    </section>

    <section id="alertsSection" class="alerts-section" style="display: none;">
      <div class="section-header">
        <div class="alert-icon">
          <i class="fas fa-exclamation-triangle"></i>
        </div>
        <h2>Manutenzioni in Scadenza</h2>
      </div>
      <div id="alertsContainer">
        <!-- Alerts will be rendered here by script.js -->
      </div>
    </section>

    <section>
      <div class="vehicles-section-header">
        <h2>I Miei Veicoli</h2>
        <button id="btnAddVehicle" class="btn btn-primary">
          <i class="fas fa-plus"></i> Aggiungi Veicolo
        </button>
      </div>
      <div id="vehiclesContainer" class="vehicles-grid">
        <!-- Vehicle cards will be rendered here by script.js -->
      </div>
      <div id="emptyState" class="empty-state" style="display: none;">
        <div class="empty-icon">
          <i class="fas fa-car-crash"></i>
        </div>
        <h3>Nessun veicolo ancora!</h3>
        <p>Aggiungi il tuo primo veicolo per iniziare a gestire le manutenzioni.</p>
        <button id="btnAddVehicleEmpty" class="btn btn-primary">
          <i class="fas fa-plus"></i> Aggiungi Veicolo
        </button>
      </div>
    </section>
  </main>

  <!-- Dialogs (Modals) -->

  <!-- Add/Edit Vehicle Dialog -->
  <div id="dialogAddVehicle" class="dialog-overlay">
    <div class="dialog">
      <div class="dialog-header">
        <h3 id="dialogAddVehicleTitle">Aggiungi Nuovo Veicolo</h3>
      </div>
      <div class="dialog-body">
        <form id="formAddVehicle">
          <div class="form-group">
            <label for="brand">Marca</label>
            <input type="text" id="brand" required>
          </div>
          <div class="form-group">
            <label for="model">Modello</label>
            <input type="text" id="model" required>
          </div>
          <div class="form-group">
            <label for="plate">Targa</label>
            <input type="text" id="plate" required maxlength="7">
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="year">Anno</label>
              <input type="number" id="year" min="1900" max="2100">
            </div>
            <div class="form-group">
              <label for="currentKm">Chilometraggio Attuale</label>
              <input type="number" id="currentKm" min="0">
            </div>
          </div>
          <div class="dialog-actions">
            <button type="button" id="btnCancelAddVehicle" class="btn btn-secondary">Annulla</button>
            <button type="submit" class="btn btn-primary">Salva Veicolo</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Add Maintenance Dialog -->
  <div id="dialogAddMaintenance" class="dialog-overlay">
    <div class="dialog">
      <div class="dialog-header">
        <h3>Aggiungi Nuova Manutenzione</h3>
        <p id="maintenanceVehicleInfo" class="dialog-subtitle"></p>
      </div>
      <div class="dialog-body">
        <form id="formAddMaintenance">
          <div class="form-group">
            <label for="type">Tipo di Manutenzione</label>
            <select id="type" required>
              <option value="" disabled selected>Seleziona tipo</option>
              <!-- Options populated by script.js -->
            </select>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="dueDate">Data Scadenza</label>
              <input type="date" id="dueDate">
            </div>
            <div class="form-group">
              <label for="dueKm">Chilometraggio Scadenza</label>
              <input type="number" id="dueKm" min="0">
            </div>
          </div>
          <div class="form-group">
            <label for="notifyDaysBefore">Notifica giorni prima</label>
            <input type="number" id="notifyDaysBefore" value="7" min="0">
          </div>
          <div class="form-group">
            <label for="notes">Note</label>
            <textarea id="notes" rows="3"></textarea>
          </div>
          <div class="dialog-actions">
            <button type="button" id="btnCancelAddMaintenance" class="btn btn-secondary">Annulla</button>
            <button type="submit" class="btn btn-primary">Aggiungi Manutenzione</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Vehicle Details Dialog -->
  <div id="dialogVehicleDetails" class="dialog-overlay dialog-large">
    <div class="dialog">
      <div class="dialog-header">
        <h3 id="detailsVehicleName"></h3>
        <p id="detailsVehicleInfo" class="dialog-subtitle"></p>
      </div>
      <div class="dialog-body">
        <div class="update-km-card">
          <label for="updateKm">Aggiorna Chilometraggio:</label>
          <div class="update-km-controls">
            <input type="number" id="updateKm" class="update-km-input" min="0">
            <button id="btnUpdateKm" class="btn btn-primary">Aggiorna</button>
          </div>
        </div>

        <div class="maintenances-list-section">
          <h3>Manutenzioni <span id="maintenanceCount"></span></h3>
          <div id="maintenancesList">
            <!-- Maintenances for the selected vehicle will be rendered here -->
          </div>
        </div>
      </div>
      <div class="dialog-footer">
        <button type="button" id="btnCloseDetails" class="btn btn-secondary">Chiudi</button>
        <button type="button" id="btnEditVehicleFromDetails" class="btn btn-secondary">
          <i class="fas fa-pencil-alt"></i> Modifica Veicolo
        </button>
        <button type="button" id="btnAddMaintenanceFromDetails" class="btn btn-primary">
          <i class="fas fa-plus"></i> Aggiungi Manutenzione
        </button>
      </div>
    </div>
  </div>

  <!-- Edit Maintenance Dialog -->
  <div id="dialogEditMaintenance" class="dialog-overlay">
    <div class="dialog">
      <div class="dialog-header">
        <h3 id="editMaintenanceTitle">Modifica Manutenzione</h3>
        <p id="editMaintenanceVehicleInfo" class="dialog-subtitle"></p>
      </div>
      <div class="dialog-body">
        <form id="formEditMaintenance">
          <div class="form-group">
            <label for="editType">Tipo di Manutenzione</label>
            <select id="editType" required>
              <option value="" disabled selected>Seleziona tipo</option>
              <!-- Options populated by script.js -->
            </select>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="editDueDate">Data Scadenza</label>
              <input type="date" id="editDueDate">
            </div>
            <div class="form-group">
              <label for="editDueKm">Chilometraggio Scadenza</label>
              <input type="number" id="editDueKm" min="0">
            </div>
          </div>
          <div class="form-group">
            <label for="editNotifyDaysBefore">Notifica giorni prima</label>
            <input type="number" id="editNotifyDaysBefore" value="7" min="0">
          </div>
          <div class="form-group">
            <label for="editNotes">Note</label>
            <textarea id="editNotes" rows="3"></textarea>
          </div>
          <div class="form-group-checkbox">
            <input type="checkbox" id="editCompleted">
            <label for="editCompleted">Manutenzione Completata</label>
          </div>
          <div class="dialog-actions">
            <button type="button" id="btnCancelEditMaintenance" class="btn btn-secondary">Annulla</button>
            <button type="submit" class="btn btn-primary">Salva Modifiche</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Generic Confirmation/Alert Dialog -->
  <div id="dialogConfirm" class="dialog-overlay">
    <div class="dialog">
      <div class="dialog-header">
        <h3 id="confirmDialogTitle">Conferma Azione</h3>
      </div>
      <div class="dialog-body">
        <p id="confirmDialogMessage"></p>
      </div>
      <div class="dialog-footer">
        <button type="button" id="btnCancelConfirm" class="btn btn-secondary">Annulla</button>
        <button type="button" id="btnConfirmAction" class="btn btn-danger">Conferma</button>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>

</html>